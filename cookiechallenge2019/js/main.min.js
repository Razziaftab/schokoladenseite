var sounds=[{id:"eat1",src:"eat1.mp3"},{id:"eat2",src:"eat2.mp3"},{id:"eat3",src:"eat3.mp3"},{id:"bg",src:"bg.mp3"},{id:"bg-2",src:"bg-2.mp3"},{id:"bg-3",src:"bg-3.mp3"},{id:"bg-4",src:"bg-4.mp3"},{id:"death",src:"death.mp3"},{id:"intro",src:"intro.mp3"},{id:"bug",src:"bug.mp3"},{id:"invader",src:"invader.mp3"}];function loadSound(){if(!createjs.Sound.initializeDefaultPlugins()){return}createjs.Sound.registerSounds(sounds,"sound/")}function playSound(a){createjs.Sound.play(a)}loadSound();function rand(b,a){return Math.floor(Math.random()*(a-b+1))+b}function toUnaryString(c,d){var a="";for(var b=0;b<c;b++){a=a+d}return a}var uid=$("body").attr("data-uid");var controlReversed=false;var lines=5;var lineWalker=2;var steps=9;var collectStep=7;var moveTime=500;var newItemTime=moveTime*3;var speedUpdateCondition=10;var speedUpdateValue=25;var selectedPackageCounter=0;var liveCounter=3;var givenPackages=0;function givePackages(){if(liveCounter>0){setTimeout(function(){givenPackages++;var a=rand(0,lines-1);var c="package-"+givenPackages;var b=rand(1,7);$(".lines .game-line-"+a).append('<div class="package step-0 '+c+" "+(b===1?"bug":"")+" "+(b===2?"space-invader":"")+'"></div>');movePackage("."+c,0);if(givenPackages%speedUpdateCondition===0){if(moveTime>0){moveTime=moveTime-speedUpdateValue}}givePackages()},newItemTime)}}function movePackage(b,c){if(liveCounter>0){$(b).removeClass("step-"+(c-1)).addClass("step-"+c);if(c<steps){if(c===collectStep){if($(b).parent().hasClass("game-line-"+lineWalker)){if($(b).hasClass("space-invader")){playSound("invader");setTimeout(function(){playSound("invader");setTimeout(function(){playSound("invader")},100)},100);selectedPackageCounter=selectedPackageCounter-3;if(selectedPackageCounter<0){selectedPackageCounter=0}}else{if($(b).hasClass("bug")){playSound("bug");$(".line-walker-bag").toggleClass("bug");if(controlReversed){controlReversed=false}else{controlReversed=true}}else{playSound("eat"+rand(1,3));selectedPackageCounter++}}$(".selected-package-counter").html(selectedPackageCounter);$(b).remove()}else{setTimeout(function(){movePackage(b,c+1)},moveTime)}}else{setTimeout(function(){movePackage(b,c+1)},moveTime)}}else{var a=false;if(!($(b).hasClass("space-invader")||$(b).hasClass("bug"))){a=true;playSound("death");liveCounter--}$(".live-counter").html(toUnaryString(liveCounter,'<img src="img/schokodrop.png" class="live-img">'));$(b).remove();if(liveCounter<=0){$(".finish .points").html(selectedPackageCounter);$(".container").removeClass("play");$(".finish").show();$(".info-site").show();updateScore();$(".highscore-form-msgs").html("");if(selectedPackageCounter>0){$("#highscore-form").show()}else{$("#highscore-form").hide()}setTimeout(function(){createjs.Sound.stop()},2000)}else{if(a){$(".live-lost").show();setTimeout(function(){$(".live-lost").hide()},50)}}}}else{$(b).remove()}}function walk(a){if(a>=0&&a<lines){$(".line-walker").removeClass("game-line-"+lineWalker).addClass("game-line-"+a);lineWalker=a}}$(".control-left").bind("touchstart",function(a){a.preventDefault();if(controlReversed){walk(lineWalker+1)}else{walk(lineWalker-1)}});if(!Modernizr.touch){$(".control-left").on("click",function(){if(controlReversed){walk(lineWalker+1)}else{walk(lineWalker-1)}})}$("body").on("keydown",function(a){if(a.which==37){if(controlReversed){walk(lineWalker+1)}else{walk(lineWalker-1)}}});$(".control-right").bind("touchstart",function(a){a.preventDefault();if(controlReversed){walk(lineWalker-1)}else{walk(lineWalker+1)}});if(!Modernizr.touch){$(".control-right").on("click",function(){if(controlReversed){walk(lineWalker-1)}else{walk(lineWalker+1)}})}$("body").on("keydown",function(a){if(a.which==39){if(controlReversed){walk(lineWalker-1)}else{walk(lineWalker+1)}}});$(".play-btn-game").click(function(){$(".line-walker-bag").removeClass("bug");$(".info-site").hide();$(".info-site .start").hide();$(".container").addClass("play");controlReversed=false;liveCounter=3;selectedPackageCounter=0;moveTime=500;givenPackages=0;$(".live-counter").html(toUnaryString(liveCounter,'<img src="img/schokodrop.png" class="live-img">'));$(".selected-package-counter").html(selectedPackageCounter);walk(2);playSound("intro");setTimeout(function(){var a=new createjs.PlayPropsConfig().set({loop:-1});createjs.Sound.play("bg",a);givePackages()},3000)});function updateScore(){var c=selectedPackageCounter;var b="score.php";var a=$.post(b,{uid:uid,score:c});a.done(function(d){if(d.state=="success"){$("span.betrag").html(d.moneyGame);$("span.collected").html(d.moneyCollected);$("span.collected").addClass(d.collectedToMuch);$(".collected-percent").css("width",d.percentCollected+"%");$(".collected-percent").attr("aria-valuenow",d.percentCollected);$("#highscore-form").find("input[name='uid']").val(uid);uid=d.newid}else{$("#highscore-form").hide();$(".highscore-form-msgs").html('<p class="error">Leider ist ein Fehler aufgetreten.<br> Bitte lade deinen Browser neu.</p>')}});a.fail(function(d){$("#highscore-form").hide();$(".highscore-form-msgs").html('<p class="error">Leider ist ein Fehler aufgetreten.<br> Bitte lade deinen Browser neu.</p>')})}$("#highscore-form").submit(function(d){d.preventDefault();var a=$(this),c=a.find("input[name='name']").val(),f=a.find("input[name='uid']").val(),e=a.attr("action");var b=$.post(e,{uid:f,score:selectedPackageCounter,name:c});b.done(function(g){if(g.state=="success"){$(".highscore ul").empty();$.each(g.highscore,function(h,i){$(".highscore ul").append('<li><div class="nickname">'+i.name+'</div> <div>Deine erspielte Spende <span class="hs-betrag">'+i.score+"</span> </div></li>")});$("html, body").animate({scrollTop:$(".highscore").offset().top},1000);$("#highscore-form").hide();$(".highscore-form-msgs").empty()}if(g.state=="invalid_name"){$(".highscore-form-msgs").html('<p class="error">Bitte geben Sie einen g√ºltigen Namen ein. Erlaubt sind Buchstaben und Zahlen sowie Bindestriche und Leerzeichen.</p>')}if(g.state=="invalid_score"||g.state=="invalid_combination"){$(".highscore-form-msgs").html('<p class="error">Leider ist ein Fehler aufgetreten.<br> Bitte lade deinen Browser neu.</p>')}if(g.state=="duplicate_name"){$(".highscore-form-msgs").html('<p class="error">Der Nickname wird schon verwendet. Bitte gebe einen anderen Nicknamen ein.</p>')}});b.fail(function(g){$("#highscore-form").hide();$(".highscore-form-msgs").html('<p class="error">Leider ist ein Fehler aufgetreten.<br> Bitte lade deinen Browser neu.</p>')})});function PopupSharing(a,j,k,e){var i=window.screenLeft!==undefined?window.screenLeft:screen.left;var b=window.screenTop!==undefined?window.screenTop:screen.top;var c=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width;var l=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;var d=((c/2)-(k/2))+i;var g=((l/2)-(e/2))+b;var f=window.open(a,j,"menubar=no, toolbar=no, resizable=yes, scrollbars=yes, width="+k+", height="+e+", top="+g+", left="+d);if(window.focus){f.focus()}return false}$(document).ready(function(){$(".hidden-content-block").each(function(){var b="";if(!$(this).prev().hasClass("hidden-content-block-wrapper")){b="first"}if(!$(this).next().hasClass("hidden-content-block")){b+=" last"}$(this).wrap('<div class="hidden-content-block-wrapper '+b+'"></div>');$(this).before('<div class="hide-content-block-toggle" id="'+$(this).data("anchor")+'"><a href="#" class="show-content-block">'+$(this).data("title")+'<i class="fa fa-chevron-down"aria-hidden="true"></i></a></div>')});$("body").on("click touch","a.show-content-block",function(){var c=$(this).children("i").first();var b=$(this).parent();c.toggleClass("rotated");b.next(".hidden-content-block").slideToggle(500,function(){});return false});if(window.location.hash){var a=window.location.hash;if($(a+" a").length){$(a+" a").click();$("html, body").animate({scrollTop:$(a).offset().top},1000)}}$(".footer").on("click touch","a",function(){var b=$(this).attr("href");if(!($(b+" a i").hasClass("rotated"))){$(b+" a").click()}$("html, body").animate({scrollTop:$(b).offset().top},1000)})});